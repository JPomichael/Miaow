<div>
    @using (Html.BeginForm("CreatePlan", "Home", FormMethod.Post))
    {   
        <label for="edit-field-trip-city-0-nid-nid">
            &nbsp;&nbsp;&nbsp;&nbsp;目的地：</label>                                       
        <input id="city" type="text" name="city" value="输入目的地" data-autocomplete="/mytour/home/searchcity" /><br />
        <label for="edit-title">
            行程名称：</label>
        <input id="tourTitle" class="form-text required" type="text" value="输入行程名称" size="40"
            name="PlanTitle" /><br />
        <label for="edit-field-trip-date-0-value">
            出发日期：</label>
        <input class="HinputText" id="txtComeTime" name="AddTime" onkeypress="javascript:return onlyDate();"
            value="" size="20" onclick="ShowTwoMonthList('txtComeTime',0,'thisDay'); return false;" />
        <span class="buttonTime" onclick="ShowTwoMonthList('txtComeTime',0,'thisDay');return false;">
        </span>
        <label for="edit-field-trip-date-0-value">
            天数：</label><input id="days" class="form-text form-autocomplete required text" type="text"
                size="10" name="Days" value="2" /><span class="field-suffix"> 天</span>
        <br />
        <input id="edit-submit" type="submit" value="创建" onclick="return  searchCheckedForm();" />
    }
</div>
<script type="text/javascript">
    $(function () {
        var days = $("#days").val();
        var city = $("#city").val();
        var tourTitle = $("#tourTitle").val();

        $(":input[data-autocomplete]").each(function () {
            $(this).autocomplete({
                source: $(this).attr("data-autocomplete")
            });
        });

        $("#tourTitle").focus(function () {
            if (this.value == "输入行程名称") {
                $("#tourTitle").val("");
            }
        }).blur(function () {
            if (this.value == "") {
                $("#tourTitle").val("输入行程名称");
            }
        });

        $("#city").focus(function () {
            if (this.value == "输入目的地") {
                $("#city").val("");
            }
        }).blur(function () {
            if (this.value == "") {
                $("#city").val("输入目的地");
            }
        });
    });

    //检验City 是否存在
    function checkcity() {
        var des = $("#city").val();
        var res = false;
        var obj =
            {
                City: des
            }
        $.ajax({
            url: "/MyTour/Home/GetDestinationIsEtist",
            Type: "GET",
            dataType: "text",
            data: obj,
            success: function (data) {
                //return  1 or 0  (存在/不存在)
                if (data == "0") {
                    res = true;
                    return res;
                }
                else {
                    res = false;
                    return res;
                }
            },
            error: function () {
                alert("JS checkCity() is error! please find admin");
            }
        });
        var close = setTimeout(function () {
            var temp = "1";
        }, 2000);
        clearTimeout(close);
        return res;
    }

    function searchCheckedForm() {
        var days = $("#days").val();
        var des = $("#city").val();

        
        if (des == "" || des == "输入目的地" ||  checkcity()== true) {
            alert("目的地不合法！");
            return false;
        }
        if ($("#tourtitle").val() == "" || $("#tourtitle").val() == "输入行程名称") {
            alert("行程不能为空或不能为提示语！");
            return false;
        }
        if ($("#txtcometime").val() == "" || $("#txtcometime").val() == "输入行程日期") {
            alert("时间不能为空或不能为提示语！");
            return false;
        }
        if (days == "" || isnan(days) == true) {
            alert("天数不能为空或不能为提示语！");
            return false;
        }
        else {
            return true;
        }
    }
</script>
